@PART[Size3AdvancedEngine]:AFTER[ReStock]
{
    //Title and description
    @title = AM-1 "Rhino"
    @description = An absolute unit of an engine. Developed just in case someone might need it. Was considered for some Sarnus proposals. Seen here in the primary vacuum optimized version.
    real_title = M-1
    real_manufacturer = Aerojet
    real_description = An absolute unit of an engine. Developed just in case someone might need it. Was considered for some Saturn and Nova proposals. Seen here in the primary vacuum optimized version.
    %tags = Rhino M-1 M1 Cryo* Saturn Nova
    @bulkheadProfiles = size6p5, srf

    //Tech and cost

    //Physical
    @rescaleFactor = 1.667       //6.25m mounting ring diameter. 5.33m engine bell (210 inches from sources) means 3.33m in KSP. This scaling is almost exact.
    @mass = 6.12//25% thrust scaling //12.24              //

    //attach nodes
    //%node_stack_top =

    @MODULE[ModulePartVariants]
    {
      @VARIANT[Size3]
      {
        @displayName = 6.25m
        @NODES
        {
          %node_stack_top = 0.0, 2.488, 0.0, 0.0, 1.0, 0.0, 2
        }
      }
      @VARIANT[Compact]
      {
        @NODES
        {
          %node_stack_top = 0.0, 0.8, 0.0, 0.0, 1.0, 0.0, 2
        }
      }
    }

    //performance
    @MODULE[ModuleEnginesFX]
    {
      @maxThrust = 1668 //25% thrust scaling
      @PROPELLANT[LiquidFuel]
      {
        @name = LqdHydrogen
        @ratio = 1.5
      }
      @PROPELLANT[Oxidizer]
      {
        @ratio = 0.1
      }
      !atmosphereCurve {}
      atmosphereCurve
      {
        key = 0 428 0 0
        key = 1 282 0 0
        key = 4 20 0 0
      }
    }
    @MODULE[ModuleGimbal]
    {
      @gimbalRange = 7.5
    }

    MODULE
  	{
  	  name = ModuleB9PartSwitch
  	  switcherDescription = Engine Config
  	  switcherDescriptionPlural = Engine Configs
  		moduleID = engineSwitch

  	  SUBTYPE
  	  {
  	    name = M1
  	    title = AM-1 "Rhino"
  			descriptionSummary = Even the baseline model of this engine is the most powerful cryogenic engine concieved.
  			descriptionDetail = <b>Thrust:</b> 1099 kN ASL / 1668 kN Vac.\n<b>Isp:</b> 282 s ASL / 428 s Vac.
        real_title = M1
  			defaultSubtypePriority = 0
  	  }

  	  SUBTYPE
  	  {
  	    name = M1U
  	    title = AM-1U "Rhino"
  	    descriptionSummary = This insanely powerful model achives the designed growth potential. Almost unbeleivable levels of power for a cryogenic engine.
  			real_title = M1-U
  	    descriptionDetail = <b>Thrust:</b> 1437 kN ASL / 2001 kN Vac.\n<b>Isp:</b> 309 s ASL / 430 s Vac.
  	    //upgradeRequired = bluedog_Saturn_Gen3
  	    addedCost = 2000
  			defaultSubtypePriority = 1

  	    MODULE
  	    {
  	      IDENTIFIER
  	      {
  	        name = ModuleEnginesFX
  	      }

  	      DATA
  	      {
  	        maxThrust = 2001 //25% thrust scaling

  	        atmosphereCurve
  	        {
  	          key = 0 430
  	          key = 1 309
  						key = 7 0.001
  	        }
  	      }
  	    }
  	  }
  	}

    //plumes
    !EFFECTS {}
    EFFECTS
    {
      engage
      {
        AUDIO
        {
          channel = Ship
          clip = sound_vent_soft
          volume = 1.0
          pitch = 2.0
          loop = false
        }
      }
      flameout
      {
        PREFAB_PARTICLE
        {
          prefabName = fx_exhaustSparks_flameout_2
          transformName = thrustTransform
          oneShot = true
        }
        AUDIO
        {
          channel = Ship
          clip = sound_explosion_low
          volume = 1.0
          pitch = 2.0
          loop = false
        }
      }
      fx-rhino-running
      {
        AUDIO
        {
          channel = Ship
          clip = sound_rocket_hard
          volume = 0.0 0.0
          volume = 0.01 0.4
          volume = 1.0 1.0
          pitch = 0.0 0.2
          pitch = 0.01 0.6
          pitch = 1.0 1.8
          loop = true
        }
        MODEL_MULTI_PARTICLE
        {
          name = core
          modelName = ReStock/FX/restock-fx-rhino-core-1
          transformName = fxTransformCore
          emission = 0.0 0.0
          emission = 0.01 0.1
          emission = 0.075 0.25
          emission = 1.0 1.0
          speed = 0.0 0.35
          speed = 1.0 1.0
          localScale = 3,3,3
        }
        MODEL_MULTI_PARTICLE
        {
          name = plume
          modelName = ReStock/FX/restock-fx-rhino-plume-1
          transformName = fxTransformPlume
          emission = 0.0 0.0
          emission = 0.01 0.1
          emission = 0.075 0.25
          emission = 1.0 1.0
          speed = 0.0 0.35
          speed = 1.0 1.0
          localScale = 3,3,3
        }
      }
    }
}

@PART[Size3AdvancedEngine]:AFTER[EngineIgnitor]
{
    @MODULE[ModuleEngineIgnitor]
    {
      @IgnitionsAvailable = 1
    }
}

@PART[Size3AdvancedEngine]:NEEDS[RealPlume,SmokeScreen]:AFTER[zzRealPlume]
{
  @EFFECTS
  {
    @Hydrolox_LowerBlaze
    {
      @MODEL_MULTI_SHURIKEN_PERSIST[Hydrolox_LowerBlaze-blaze]
      {
        @fixedScale = 3
      }
      @MODEL_MULTI_SHURIKEN_PERSIST[Hydrolox_LowerBlaze-flare]
      {
        @fixedScale = 0.83
        @localPosition = 0,0,1.5
      }
      @MODEL_MULTI_SHURIKEN_PERSIST[Hydrolox_LowerBlaze-fume]
      {
        @fixedScale = 3.7
      }
      @MODEL_MULTI_SHURIKEN_PERSIST[Hydrolox_LowerBlaze-plume]
      {
        @fixedScale = 3
      }
      @MODEL_MULTI_SHURIKEN_PERSIST[Hydrolox_LowerBlaze-shockcone]
      {
        @fixedScale = 2.5
      }
    }
  }
}
